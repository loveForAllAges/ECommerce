{% extends 'base.html' %}
{% load static %}
{% block content %}
{% load my_filters %}


<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-24 lg:pb-32">
    <div class="flex items-center justify-between h-12 sm:h-16">
        <div class="relative inline-block text-left">
            <div class="">
                <button id="sortDropdownBtn" data-dropdown-toggle="sortDropdown" data-dropdown-delay="150" type="button" class="group inline-flex justify-center items-center text-sm duration-150 text-gray-900 hover:text-blue-700">
                    Сортировать
                    <svg class="ml-2 h-4 w-4 duration-150 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>

            <div id="sortDropdown" class="z-10 hidden w-56 bg-white divide-y divide-gray-100 rounded shadow-2xl ring-1 ring-black ring-opacity-5">
                <ul class="p-3 space-y-1 text-sm text-gray-700" aria-labelledby="sortDropdownBtn">
                    <li>
                        <a href="{% url 'category' %}{% if 'sort' in request.GET %}?{% remove_tag 'sort' %}&sort=popular{% else %}?{{ request.GET.urlencode }}&sort=popular{% endif %}" class="{% if not request.GET.sort or 'popular' == request.GET.sort %}text-gray-900 font-medium{% endif %} text-gray-500 flex items-center p-2 rounded-md hover:bg-gray-100">
                            <label class="-m-2 ml-0 p-2 w-full text-sm rounded">Сначала популярные</label>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'category' %}{% if 'sort' in request.GET %}?{% remove_tag 'sort' %}&sort=new{% else %}?{{ request.GET.urlencode }}&sort=new{% endif %}" class="{% if 'new' == request.GET.sort %}text-gray-900 font-medium{% endif %} text-gray-500 flex items-center p-2 rounded-md hover:bg-gray-100">
                            <label class="-m-2 ml-0 p-2 w-full text-sm rounded">Сначала новые</label>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'category' %}{% if 'sort' in request.GET %}?{% remove_tag 'sort' %}&sort=expensive{% else %}?{{ request.GET.urlencode }}&sort=expensive{% endif %}" class="{% if 'expensive' == request.GET.sort %}text-gray-900 font-medium{% endif %} text-gray-500 flex items-center p-2 rounded-md hover:bg-gray-100">
                            <label class="-m-2 ml-0 p-2 w-full text-sm rounded">Сначала дороже</label>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'category' %}{% if 'sort' in request.GET %}?{% remove_tag 'sort' %}&sort=cheaper{% else %}?{{ request.GET.urlencode }}&sort=cheaper{% endif %}" class="{% if 'cheaper' == request.GET.sort %}text-gray-900 font-medium{% endif %} text-gray-500 flex items-center p-2 rounded-md hover:bg-gray-100">
                            <label class="-m-2 ml-0 p-2 w-full text-sm rounded">Сначала дешевле</label>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <button type="button" data-drawer-target="filtersModal" data-drawer-show="filtersModal" data-drawer-placement="right" aria-controls="filtersModal" class="inline-block text-sm text-gray-900 hover:text-blue-700">
            Фильтры
            {% if total_active_tags_count %}
            <span class="ml-2 text-xs text-gray-500">{{ total_active_tags_count }}</span>
            {% endif %}
        </button>
    </div>
  
  
    {% if product_list %}
    <div class="mt-10 grid grid-cols-2 gap-y-4 gap-x-4 md:gap-x-6 md:gap-y-8 md:grid-cols-3 lg:grid-cols-4 lg:gap-x-8 lg:gap-y-10">
        {% for product in product_list %}
        {% include 'components/productCard.html' %}
        {% endfor %}
    </div>
    {% else %}
    <div class="mt-10 text-center text-sm">
        <svg class="mx-auto h-6 w-6 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.182 16.318A4.486 4.486 0 0012.016 15a4.486 4.486 0 00-3.198 1.318M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75zm-.375 0h.008v.015h-.008V9.75zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75zm-.375 0h.008v.015h-.008V9.75z"></path>
        </svg>
        {% if request.GET.q %}
        <p class="mt-4 mb-2 text-sm text-gray-900">По запросу {{ request.GET.q }} ничего не найдено</p>
        <a href="{% url 'category' %}" class="duration-150 text-gray-500 hover:text-gray-600">Очистить фильтры</a>
        {% else %}
        <p class="mt-4 text-sm text-gray-900">Ничего не найдено</p>
        {% endif %}
    </div>
    {% endif %}
</div>


{% include 'components/filtersModal.html' %}
{% endblock content %}
