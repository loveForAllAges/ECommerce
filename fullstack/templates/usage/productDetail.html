{% extends 'base.html' %}
{% load static %}
{% load my_filters %}

{% block content %}
<div class="mx-auto py-16 px-4 sm:py-24 xl:px-0 sm:max-w-lg lg:max-w-7xl lg:grid lg:grid-cols-2 lg:gap-x-8">
    <div class="">
        <div id="default-carousel" class="relative w-full" data-carousel="slide">
            <div class="relative aspect-w-1 aspect-h-1 overflow-hidden">
                {% for image in object.productimage_set.all %}
                <div class="hidden duration-700 ease-in-out" data-carousel-item>
                    <img src="{{ image.image.url }}" class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                </div>
                {% endfor %}
            </div>
            <div class="absolute z-30 flex space-x-3 -translate-x-1/2 bottom-5 left-1/2 p-1 bg-slate-100 rounded-full">
                {% for image in object.productimage_set.all %}
                <button type="button" class="w-3 h-3 rounded-full shadow bg-gray-300" aria-current="true" aria-label="Slide {{ forloop.counter }}" data-carousel-slide-to="{{ forloop.counter }}"></button>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="mt-8 lg:mt-0">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">{{ object.name }}</h1>
        <p class="mt-4 text-lg text-gray-900 sm:text-xl">{{ object.price|add_space_separator }} ₽</p>
        <p class="mt-4 text-base text-gray-500">{{ object.description }}</p>

        <div class="mt-8 space-y-4">
            <div class="flex items-center justify-between">
                <h2 class="text-sm font-medium text-gray-900">Цвет</h2>
            </div>

            <div class="flex items-center space-x-3 overflow-x-auto overflow-y-auto">
                {% for color in object.color.all %}
                <div class="">
                    <input type="radio" id="color-{{ color.name }}" name="color" value="color-{{ color.name }}" class="hidden peer" required>
                    <label for="color-{{ color.name }}" class="duration-150 -m-0.5 relative p-0.5 rounded-full flex items-center justify-center cursor-pointer peer-checked:ring-2 peer-checked:ring-blue-600">
                        <span aria-hidden="true" class="h-8 w-8 bg-{{ color.css }} border border-black border-opacity-10 rounded-full"></span>
                    </label>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="mt-4 space-y-4">
            <div class="flex items-center justify-between">
                <h2 class="text-sm font-medium text-gray-900">Размер</h2>
                <a href="#" class="text-sm font-medium text-blue-600 hover:text-blue-500">Таблица размеров</a>
            </div>

            <div class="grid grid-cols-3 gap-3 sm:grid-cols-6">
                {% for size in object.size.all %}
                <div>
                    <input type="radio" id="size-{{ size.slug }}" name="size" value="size-{{ size.slug }}" class="hidden peer" required>
                    <label for="size-{{ size.slug }}" class="duration-150 border rounded-lg py-3 px-6 flex items-center justify-center text-sm font-medium uppercase sm:flex-1 cursor-pointer focus:outline-none bg-white border-gray-200 text-gray-900 hover:bg-gray-50 peer-checked:text-white peer-checked:bg-blue-600 peer-checked:border-blue-600">
                        {{ size.name }}
                    </label>
                </div>
                {% endfor %}
            </div>
        </div>

        <form class="mt-8">
            <div class="flex space-x-4">
                <button data-product="{{ object.id }}" data-action="add" type="button" class="addToCart w-full justify-center inline-flex items-center rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                    Купить
                </button>
                {% if object in request.user.wishlist.all %}
                <button type="button" data-product="{{ object.id }}" data-action="delete" class="addToWishlist inline-flex items-center rounded-xl p-2 text-rose-500 hover:text-rose-600">
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
                    </svg>
                </button>
                {% else %}
                <button type="button" {% if request.user.is_anonymous %}data-modal-target="permissionModal" data-modal-toggle="permissionModal"{% else %}data-product="{{ object.id }}" data-action="add"{% endif %} class="{% if request.user.is_authenticated %}addToWishlist{% endif %} inline-flex items-center rounded-xl p-2 text-gray-400 hover:text-gray-500">
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
                    </svg>
                </button>
                {% endif %}
            </div>
        </form>


        <div class="mt-8">
            <div id="accordion-flush" data-accordion="collapse" data-active-classes="text-gray-900" data-inactive-classes="text-gray-500 dark:text-gray-400">
                <div class="py-6">
                    <h3 id="accordion-cat" class="-mx-2 -my-3 flow-root">
                      <button type="button" class="m-0 flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400" data-accordion-target="#accordion-cat-body" aria-expanded="false" aria-controls="accordion-cat-body">
                        <span class="font-medium text-gray-900">Доставка</span>
                        <span class="ml-6 flex items-center">
                          <svg data-accordion-icon class="rotate-0 h-5 w-5 transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                          </svg>
                        </span>
                      </button>
                    </h3>
                    <div id="accordion-cat-body" class="hidden pt-6" aria-labelledby="accordion-cat">
                        <p class="text-sm text-gray-500">ВДАОЫВДЛАОЫДВЛАО воаыдлвоа дылвоа дывлоадывл аоыдвл аоыдвла оывдлаоы аывд лаоыфвда воыа ло</p>
                    </div>
                </div>
                
                <div class="border-t border-gray-200 py-6">
                    <h3 id="accordion-brand" class="-mx-2 -my-3 flow-root">
                      <button type="button" class="m-0 flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400" data-accordion-target="#accordion-brand-body" aria-expanded="false" aria-controls="accordion-brand-body">
                        <span class="font-medium text-gray-900">Возврат</span>
                        <span class="ml-6 flex items-center">
                          <svg data-accordion-icon class="rotate-0 h-5 w-5 transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                          </svg>
                        </span>
                      </button>
                    </h3>
                    <div id="accordion-brand-body" class="hidden pt-6" aria-labelledby="accordion-brand">
                        <p class="text-sm text-gray-500">ВДАОЫВДЛАОЫДВЛАО воаыдлвоа дылвоа дывлоадывл аоыдвл аоыдвла оывдлаоы аывд лаоыфвда воыа ло</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="mx-auto max-w-7xl py-24 px-4 sm:py-32 sm:px-6 lg:px-8">
    <div class="">
        <div class="flex items-center justify-between">
            <h2 class="text-2xl font-bold tracking-tight text-gray-900">Рекомендации</h2>
            <a href="#" class="text-sm font-semibold text-blue-600 hover:text-blue-500 block">
                Смотреть все
                <span aria-hidden="true"> →</span>
            </a>
        </div>
        <div class="mt-8">
            <div class="grid grid-cols-2 gap-y-10 gap-x-6 sm:grid-cols-3 lg:grid-cols-4 xl:gap-x-8">
                {% for object in rec_list %}
                <div class="relative group hover:opacity-75 duration-150">
                    <div>
                        <div class="aspect-w-1 aspect-h-1 overflow-hidden rounded-xl">
                            {% for image in object.productimage_set.all %}
                            {% if image.is_main %}
                                <img src="{{ image.image.url }}" class="h-full w-full object-cover object-center">
                            {% endif %}
                            {% endfor %}
                        </div>
                        <h3 class="mt-4 font-semibold text-gray-900">
                            <a href="{% url 'product-detail' object.id %}">
                                <span aria-hidden="true" class="absolute inset-0"></span>
                                {{ object.name }}
                            </a>
                        </h3>
                        <p class="mt-1 text-gray-900">{{ object.price|add_space_separator }} ₽</p>
                    </div>
                    <div class="absolute top-0 right-0 flex overflow-hidden pt-2 pr-2">
                        {% if object in request.user.wishlist.all %}
                        <button type="button" data-product="{{ object.id }}" data-action="delete" class="addToWishlist p-1 text-gray-400 hover:text-gray-500">               
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 text-rose-500 hover:text-rose-600">
                                <path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z" />
                            </svg>
                        </button>
                        {% else %}
                        <button type="button" data-product="{{ object.id }}" data-action="add" class="addToWishlist p-1 text-gray-400 hover:text-gray-500">               
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"></path>
                            </svg>
                        </button>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}